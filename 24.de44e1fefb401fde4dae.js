(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{hmYF:function(n,l,o){"use strict";o.r(l);var e=o("CcnG"),t=o("PlN7"),u=o("t/Na"),i=o("XrUY"),s=function(){function n(n,l){this.service=n,this.http=l,this.userColor=!1,this.bookColor=!1,this.controlClock=!1,this.ticket={},this.libros=[],this.date=(new Date).toISOString().slice(0,19).replace("T"," "),this.dateNew=new Date(Date.now()+2592e5).toISOString().slice(0,19).replace("T"," "),this.dateWithExtension=new Date(Date.now()+432e6).toISOString().slice(0,19).replace("T"," "),this.data={},this.usuario={},this.librosPrestamos=[]}return n.prototype.ngOnInit=function(){this.service.backToHome()||(this.service.libro=!0,this.extension=!1,this.contLibros=0,this.timeout()),this.usuario=JSON.parse(sessionStorage.getItem("usuario"))},n.prototype.user=function(){this.librosPrestamos=[],this.libros=[],this.contLibros=0;var n=new u.g({"Content-Type":"application/json","No-Auth":"True"});this.info(n),this.obtenerLibros(n),this.searchContBooks(n)},n.prototype.color=function(){var n=this,l=new u.g({"Content-Type":"application/json","No-Auth":"True"});this.http.post(i.a.dominio+"/exists",this.data,{headers:l,responseType:"text"}).subscribe(function(l){"True"===l?(n.userColor=!0,n.service.hasUser=!0,n.controlClock=!1):(n.userColor=!1,n.service.hasUser=!1)},function(n){console.log(n)})},n.prototype.libro=function(){var n=this,l=new u.g({"Content-Type":"application/json","No-Auth":"True"});this.http.post(i.a.dominio+"/book",this.data,{headers:l,responseType:"text"}).subscribe(function(l){n.bookColor="False"!==l},function(n){console.log("ERROR")})},n.prototype.pushBook=function(){var n=this;if(this.librosPrestamos.includes(this.data.isbn))alert("Tiene ese libro en posesion");else if(5!==this.contLibros){if(this.bookColor&&this.penalizaciones<3){var l=new u.g({"Content-Type":"application/json","No-Auth":"True"});this.http.post(i.a.dominio+"/book-exists",this.data,{headers:l,responseType:"text"}).subscribe(function(l){"False"===l||(n.librosPrestamos.push(n.data.isbn),(l=JSON.parse(l)).extension=n.extension,l.date=n.date,l.dateEntrega=n.extension?n.dateWithExtension:n.dateNew,n.libros.push(l),n.extension=!1,n.data.isbn="",n.bookColor=!1,n.contLibros++)},function(n){console.log("ERROR")})}}else alert("Ya no puede sacar libros por que tiene 5 en posesion")},n.prototype.info=function(n){var l=this;this.http.post(i.a.dominio+"/user-info",this.data,{headers:n,responseType:"text"}).subscribe(function(n){console.log(n),"False"===n||(n=JSON.parse(n),l.penalizaciones=n.penalizaciones,console.log("penalizaciones "+l.penalizaciones),l.service.userPrestmamo=n,l.controlClock=!0)},function(n){console.log("ERROR"),console.log(n),l.controlClock=!1})},n.prototype.obtenerLibros=function(n){var l=this;this.http.post(i.a.dominio+"/libros-en-posesion",this.data,{headers:n,responseType:"text"}).subscribe(function(n){var o=JSON.parse(n);for(var e in o)l.librosPrestamos.push(o[e]);console.log(l.librosPrestamos),l.controlClock=!0},function(n){console.log(n),l.controlClock=!1})},n.prototype.searchContBooks=function(n){var l=this;this.http.post(i.a.dominio+"/cont-books",this.data,{headers:n,responseType:"text"}).subscribe(function(n){l.contLibros=Number(n),console.log("contLibros "+n),l.controlClock=!0},function(n){console.log(n),l.controlClock=!1})},n.prototype.confirmar=function(){var n=this;this.ticket.usuario=this.data.usuario,this.ticket.libros=this.service.libros;var l=new u.g({"Content-Type":"application/json","No-Auth":"True"});this.http.post(i.a.dominio+"/prestamo-libro",this.ticket,{headers:l,responseType:"text"}).subscribe(function(l){console.log(l),n.service.presentAlert("Prestamo creado","El prestamo fue creado"),n.libros=[]},function(n){console.log("ERROR"),console.log(n)}),console.log(this.ticket)},n.prototype.timeout=function(){var n=this;setTimeout(function(){n.userColor&&!n.controlClock&&n.user(),n.timeout()},1e3)},n}(),r=function(){return function(){}}(),a=o("pMnS"),c=o("oBZk"),b=o("ZZ/e"),p=o("Ip0R"),d=o("gIcY"),h=o("mrSG"),g=o("VZ/U"),C=function(){function n(n,l){this.modalController=n,this.service=l}return n.prototype.presentModal=function(){return h.b(this,void 0,void 0,function(){return h.e(this,function(n){switch(n.label){case 0:return this.service.hasUser?[4,this.modalController.create({component:g.a})]:[3,3];case 1:return[4,n.sent().present()];case 2:return[2,n.sent()];case 3:return[2]}})})},n.prototype.ngOnInit=function(){},n}(),f=e.nb({encapsulation:0,styles:[[""]],data:{}});function k(n){return e.Fb(0,[(n()(),e.pb(0,0,null,null,3,"ion-button",[["id","bonton_info"],["shape","round"]],null,[[null,"click"]],function(n,l,o){var e=!0;return"click"===l&&(e=!1!==n.component.presentModal()&&e),e},c.v,c.b)),e.ob(1,49152,null,0,b.j,[e.h,e.k],{shape:[0,"shape"]},null),(n()(),e.pb(2,0,null,0,1,"ion-icon",[["name","eye"]],null,null,null,c.F,c.l)),e.ob(3,49152,null,0,b.B,[e.h,e.k],{name:[0,"name"]},null)],function(n,l){n(l,1,0,"round"),n(l,3,0,"eye")},null)}var m=o("0iMz"),v=o("t6La"),x=e.nb({encapsulation:0,styles:[[".prestamo_libro[_ngcontent-%COMP%]{text-align:center;top:10%;width:100%}#boton_info[_ngcontent-%COMP%]{width:10px}.datagrid[_ngcontent-%COMP%]{text-align:right;top:20%}.libro[_ngcontent-%COMP%], .usuario[_ngcontent-%COMP%]{display:flex}.extension[_ngcontent-%COMP%]{display:inline-flex;text-align:center}p[_ngcontent-%COMP%]{margin:auto}.espaciado[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{margin-bottom:8px}"]],data:{}});function y(n){return e.Fb(0,[(n()(),e.pb(0,0,null,null,59,"ion-content",[["padding",""]],null,null,null,c.C,c.i)),e.ob(1,49152,null,0,b.t,[e.h,e.k],null,null),(n()(),e.pb(2,0,null,0,57,"ion-content",[["class","prestamo_libro"]],null,null,null,c.C,c.i)),e.ob(3,49152,null,0,b.t,[e.h,e.k],null,null),(n()(),e.pb(4,0,null,0,16,"div",[["class","usuario"]],null,null,null,null,null)),(n()(),e.pb(5,0,null,null,1,"p",[],null,null,null,null,null)),(n()(),e.Eb(-1,null,["C\xf3digo de usuario:"])),(n()(),e.pb(7,0,null,null,8,"ion-input",[["placeholder","Ingrese..."]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"keyup"],[null,"keydown.enter"],[null,"ngModelChange"],[null,"ionBlur"],[null,"ionChange"]],function(n,l,o){var t=!0,u=n.component;return"ionBlur"===l&&(t=!1!==e.zb(n,10)._handleBlurEvent()&&t),"ionChange"===l&&(t=!1!==e.zb(n,10)._handleInputEvent(o.target.value)&&t),"keyup"===l&&(t=!1!==u.color()&&t),"keydown.enter"===l&&(t=!1!==u.user()&&t),"ngModelChange"===l&&(t=!1!==(u.data.usuario=o)&&t),t},c.G,c.m)),e.ob(8,278528,null,0,p.l,[e.t,e.k,e.D],{ngStyle:[0,"ngStyle"]},null),e.Ab(9,{color:0}),e.ob(10,16384,null,0,b.Mb,[e.k],null,null),e.Bb(1024,null,d.e,function(n){return[n]},[b.Mb]),e.ob(12,671744,null,0,d.h,[[8,null],[8,null],[8,null],[6,d.e]],{model:[0,"model"]},{update:"ngModelChange"}),e.Bb(2048,null,d.f,null,[d.h]),e.ob(14,16384,null,0,d.g,[[4,d.f]],null,null),e.ob(15,49152,null,0,b.F,[e.h,e.k],{placeholder:[0,"placeholder"]},null),(n()(),e.pb(16,0,null,null,2,"div",[],[[8,"hidden",0]],null,null,null,null)),(n()(),e.pb(17,0,null,null,1,"ion-spinner",[["name","dots"]],[[8,"hidden",0]],null,null,c.M,c.s)),e.ob(18,49152,null,0,b.qb,[e.h,e.k],{name:[0,"name"]},null),(n()(),e.pb(19,0,null,null,1,"app-modal-user",[],null,null,null,k,f)),e.ob(20,114688,null,0,C,[b.Gb,t.a],null,null),(n()(),e.pb(21,0,null,0,15,"div",[["class","libro"]],null,null,null,null,null)),(n()(),e.pb(22,0,null,null,1,"p",[],null,null,null,null,null)),(n()(),e.Eb(-1,null,["C\xf3digo de libro:"])),(n()(),e.pb(24,0,null,null,8,"ion-input",[["placeholder","Ingrese..."]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"keydown.enter"],[null,"keyup"],[null,"ngModelChange"],[null,"ionBlur"],[null,"ionChange"]],function(n,l,o){var t=!0,u=n.component;return"ionBlur"===l&&(t=!1!==e.zb(n,27)._handleBlurEvent()&&t),"ionChange"===l&&(t=!1!==e.zb(n,27)._handleInputEvent(o.target.value)&&t),"keydown.enter"===l&&(t=!1!==u.pushBook()&&t),"keyup"===l&&(t=!1!==u.libro()&&t),"ngModelChange"===l&&(t=!1!==(u.data.isbn=o)&&t),t},c.G,c.m)),e.ob(25,278528,null,0,p.l,[e.t,e.k,e.D],{ngStyle:[0,"ngStyle"]},null),e.Ab(26,{color:0}),e.ob(27,16384,null,0,b.Mb,[e.k],null,null),e.Bb(1024,null,d.e,function(n){return[n]},[b.Mb]),e.ob(29,671744,null,0,d.h,[[8,null],[8,null],[8,null],[6,d.e]],{model:[0,"model"]},{update:"ngModelChange"}),e.Bb(2048,null,d.f,null,[d.h]),e.ob(31,16384,null,0,d.g,[[4,d.f]],null,null),e.ob(32,49152,null,0,b.F,[e.h,e.k],{placeholder:[0,"placeholder"]},null),(n()(),e.pb(33,0,null,null,3,"ion-button",[["id","bonton_info"],["shape","round"]],null,[[null,"click"]],function(n,l,o){var e=!0;return"click"===l&&(e=!1!==n.component.pushBook()&&e),e},c.v,c.b)),e.ob(34,49152,null,0,b.j,[e.h,e.k],{shape:[0,"shape"]},null),(n()(),e.pb(35,0,null,0,1,"ion-icon",[["name","add-circle-outline"]],null,null,null,c.F,c.l)),e.ob(36,49152,null,0,b.B,[e.h,e.k],{name:[0,"name"]},null),(n()(),e.pb(37,0,null,0,16,"div",[["class","espaciado"]],null,null,null,null,null)),(n()(),e.pb(38,0,null,null,9,"div",[["class","extension"]],null,null,null,null,null)),(n()(),e.pb(39,0,null,null,6,"ion-checkbox",[["checked","extension"],["color","light"],["id","checkbox_extend"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"ionBlur"],[null,"ionChange"]],function(n,l,o){var t=!0,u=n.component;return"ionBlur"===l&&(t=!1!==e.zb(n,40)._handleBlurEvent()&&t),"ionChange"===l&&(t=!1!==e.zb(n,40)._handleIonChange(o.target.checked)&&t),"ngModelChange"===l&&(t=!1!==(u.extension=o)&&t),t},c.A,c.g)),e.ob(40,16384,null,0,b.c,[e.k],null,null),e.Bb(1024,null,d.e,function(n){return[n]},[b.c]),e.ob(42,671744,null,0,d.h,[[8,null],[8,null],[8,null],[6,d.e]],{model:[0,"model"]},{update:"ngModelChange"}),e.Bb(2048,null,d.f,null,[d.h]),e.ob(44,16384,null,0,d.g,[[4,d.f]],null,null),e.ob(45,49152,null,0,b.q,[e.h,e.k],{color:[0,"color"],checked:[1,"checked"]},null),(n()(),e.pb(46,0,null,null,1,"p",[],null,null,null,null,null)),(n()(),e.Eb(-1,null,["Extension"])),(n()(),e.pb(48,0,null,null,2,"div",[],null,null,null,null,null)),(n()(),e.pb(49,0,null,null,1,"p",[],null,null,null,null,null)),(n()(),e.Eb(50,null,["Empleado: ",""])),(n()(),e.pb(51,0,null,null,2,"div",[],null,null,null,null,null)),(n()(),e.pb(52,0,null,null,1,"p",[],null,null,null,null,null)),(n()(),e.Eb(53,null,["Codigo:",""])),(n()(),e.pb(54,0,null,0,2,"ion-button",[["expand","full"]],null,[[null,"click"]],function(n,l,o){var e=!0;return"click"===l&&(e=!1!==n.component.confirmar()&&e),e},c.v,c.b)),e.ob(55,49152,null,0,b.j,[e.h,e.k],{expand:[0,"expand"]},null),(n()(),e.Eb(-1,0,["Generar tickect"])),(n()(),e.pb(57,0,null,0,0,"br",[],null,null,null,null,null)),(n()(),e.pb(58,0,null,0,1,"app-datagrid",[["class","datagrid"]],null,null,null,m.b,m.a)),e.ob(59,638976,null,0,v.a,[t.a,u.c],{info:[0,"info"],mostrar:[1,"mostrar"],libro:[2,"libro"]},null)],function(n,l){var o=l.component,e=n(l,9,0,o.userColor?"green":"red");n(l,8,0,e),n(l,12,0,o.data.usuario),n(l,15,0,"Ingrese..."),n(l,18,0,"dots"),n(l,20,0);var t=n(l,26,0,o.bookColor?"green":"red");n(l,25,0,t),n(l,29,0,o.data.isbn),n(l,32,0,"Ingrese..."),n(l,34,0,"round"),n(l,36,0,"add-circle-outline"),n(l,42,0,o.extension),n(l,45,0,"light","extension"),n(l,55,0,"full"),n(l,59,0,o.libros,!0,!0)},function(n,l){var o=l.component;n(l,7,0,e.zb(l,14).ngClassUntouched,e.zb(l,14).ngClassTouched,e.zb(l,14).ngClassPristine,e.zb(l,14).ngClassDirty,e.zb(l,14).ngClassValid,e.zb(l,14).ngClassInvalid,e.zb(l,14).ngClassPending),n(l,16,0,!o.userColor),n(l,17,0,o.controlClock),n(l,24,0,e.zb(l,31).ngClassUntouched,e.zb(l,31).ngClassTouched,e.zb(l,31).ngClassPristine,e.zb(l,31).ngClassDirty,e.zb(l,31).ngClassValid,e.zb(l,31).ngClassInvalid,e.zb(l,31).ngClassPending),n(l,39,0,e.zb(l,44).ngClassUntouched,e.zb(l,44).ngClassTouched,e.zb(l,44).ngClassPristine,e.zb(l,44).ngClassDirty,e.zb(l,44).ngClassValid,e.zb(l,44).ngClassInvalid,e.zb(l,44).ngClassPending),n(l,50,0,o.usuario.nombre),n(l,53,0,o.usuario.id_usuario)})}function z(n){return e.Fb(0,[(n()(),e.pb(0,0,null,null,1,"app-prestamo-libro",[],null,null,null,y,x)),e.ob(1,114688,null,0,s,[t.a,u.c],null,null)],function(n,l){n(l,1,0)},null)}var M=e.lb("app-prestamo-libro",s,z,{},{},[]),T=o("ZYCi"),w=o("j1ZV");o.d(l,"PrestamoLibroPageModuleNgFactory",function(){return P});var P=e.mb(r,[],function(n){return e.wb([e.xb(512,e.j,e.bb,[[8,[a.a,M]],[3,e.j],e.x]),e.xb(4608,p.k,p.j,[e.u,[2,p.r]]),e.xb(4608,d.k,d.k,[]),e.xb(4608,b.b,b.b,[e.z,e.g]),e.xb(4608,b.Gb,b.Gb,[b.b,e.j,e.q]),e.xb(4608,b.Kb,b.Kb,[b.b,e.j,e.q]),e.xb(1073742336,p.b,p.b,[]),e.xb(1073742336,d.j,d.j,[]),e.xb(1073742336,d.a,d.a,[]),e.xb(1073742336,b.Cb,b.Cb,[]),e.xb(1073742336,T.n,T.n,[[2,T.t],[2,T.m]]),e.xb(1073742336,w.a,w.a,[]),e.xb(1073742336,r,r,[]),e.xb(1024,T.k,function(){return[[{path:"",component:s}]]},[])])})}}]);