(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{x88o:function(n,e,l){"use strict";l.r(e);var t=l("CcnG"),o=l("XrUY"),a=l("t/Na"),i=l("PlN7"),r=function(){function n(n,e){this.http=n,this.service=e,this.data={},this.materiales=[],this.materialesPrestados=[],this.controlClock=!1,this.date=(new Date).toISOString().slice(0,19).replace("T"," "),this.dateNew=new Date(Date.now()+864e5).toISOString().slice(0,19).replace("T"," "),this.usuario={},this.ticket={}}return n.prototype.ngOnInit=function(){this.service.backToHome()||(this.contMaterial=0,this.timeout()),this.usuario=JSON.parse(sessionStorage.getItem("usuario"))},n.prototype.user=function(){this.materialesPrestados=[],this.materiales=[],this.contMaterial=0;var n=new a.g({"Content-Type":"application/json","No-Auth":"True"});this.info(n),this.obtenerMateriales(n),this.searchContMaterials(n)},n.prototype.colorMaterial=function(){var n=this,e=new a.g({"Content-Type":"application/json","No-Auth":"True"});this.http.post(o.a.dominio+"/material",this.data,{headers:e,responseType:"text"}).subscribe(function(e){n.materialColor="False"!==e},function(n){console.log("ERROR")})},n.prototype.color=function(){var n=this,e=new a.g({"Content-Type":"application/json","No-Auth":"True"});this.http.post(o.a.dominio+"/exists-maestro",this.data,{headers:e,responseType:"text"}).subscribe(function(e){"True"===e?(n.userColor=!0,n.service.hasUser=!0,n.controlClock=!1):(n.userColor=!1,n.service.hasUser=!1)},function(n){console.log(n)})},n.prototype.searchContMaterials=function(n){var e=this;this.http.post(o.a.dominio+"/cont-materials",this.data,{headers:n,responseType:"text"}).subscribe(function(n){e.contMaterial=Number(n),console.log("contLibros "+n),e.controlClock=!0},function(n){console.log(n),e.controlClock=!1})},n.prototype.pushMaterial=function(){var n=this;if(this.materialesPrestados.includes(this.data.numSerie))alert("Tiene ese libro en posesion");else if(3!==this.contMaterial){if(this.materialColor&&this.userColor){var e=new a.g({"Content-Type":"application/json","No-Auth":"True"});this.http.post(o.a.dominio+"/material-exists",this.data,{headers:e,responseType:"text"}).subscribe(function(e){if("False"===e);else{if(e=JSON.parse(e),n.materialesPrestados.includes(e.tipo))return void alert("Ya tiene de ese tipo de material");n.materialesPrestados.push(n.info.tipo),e.date=n.date,e.dateEntrega=n.dateNew,n.materiales.push(e),n.data.numSerie="",n.materialColor=!1,n.contMaterial++}},function(n){console.log("ERROR")})}}else alert("Ya no puede sacar libros por que tiene 3 en posesion")},n.prototype.info=function(n){var e=this;this.http.post(o.a.dominio+"/user-info",this.data,{headers:n,responseType:"text"}).subscribe(function(n){console.log(n),"False"===n||(n=JSON.parse(n),e.penalizaciones=n.penalizaciones,console.log("penalizaciones "+e.penalizaciones),e.service.userPrestmamo=n,e.controlClock=!0)},function(n){console.log("ERROR"),console.log(n),e.controlClock=!1})},n.prototype.obtenerMateriales=function(n){var e=this;this.http.post(o.a.dominio+"/materiales-en-posesion",this.data,{headers:n,responseType:"text"}).subscribe(function(n){var l=JSON.parse(n);for(var t in l)e.materialesPrestados.push(l[t]);console.log(e.materialesPrestados),e.controlClock=!0},function(n){console.log(n),e.controlClock=!1})},n.prototype.timeout=function(){var n=this;setTimeout(function(){n.userColor&&!n.controlClock&&n.user(),n.timeout()},1e3)},n.prototype.confirmar=function(){var n=this;this.ticket.usuario=this.data.usuario,this.ticket.materiales=this.materiales;var e=new a.g({"Content-Type":"application/json","No-Auth":"True"});this.http.post(o.a.dominio+"/prestamo-material",this.ticket,{headers:e,responseType:"text"}).subscribe(function(e){console.log(e),n.service.presentAlert("Prestamo creado","El prestamo fue creado"),n.materiales=[]},function(n){console.log("ERROR"),console.log(n)}),console.log(this.ticket)},n}(),s=function(){return function(){}}(),u=l("pMnS"),c=l("oBZk"),p=l("ZZ/e"),b=l("Ip0R"),h=l("gIcY"),d=l("0iMz"),g=l("t6La"),m=t.nb({encapsulation:0,styles:[[".prestamo[_ngcontent-%COMP%]{top:10%}.material[_ngcontent-%COMP%]{display:flex}.datagrid[_ngcontent-%COMP%]{text-align:right;top:20%}"]],data:{}});function f(n){return t.Fb(0,[(n()(),t.pb(0,0,null,null,36,"ion-content",[["class","prestamo"]],null,null,null,c.C,c.i)),t.ob(1,49152,null,0,p.t,[t.h,t.k],null,null),(n()(),t.pb(2,0,null,0,15,"ion-item",[],null,null,null,c.H,c.n)),t.ob(3,49152,null,0,p.G,[t.h,t.k],null,null),(n()(),t.pb(4,0,null,0,2,"ion-label",[],null,null,null,c.I,c.o)),t.ob(5,49152,null,0,p.M,[t.h,t.k],null,null),(n()(),t.Eb(-1,0,["C\xf3digo de usuario:"])),(n()(),t.pb(7,0,null,0,10,"ion-input",[["pattern","\\d[0-9]+"],["placeholder","Ingrese..."],["type","number"]],[[1,"pattern",0],[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"keyup"],[null,"ngModelChange"],[null,"ionBlur"],[null,"ionChange"]],function(n,e,l){var o=!0,a=n.component;return"ionBlur"===e&&(o=!1!==t.zb(n,12)._handleBlurEvent()&&o),"ionChange"===e&&(o=!1!==t.zb(n,12)._handleIonChange(l.target.value)&&o),"keyup"===e&&(o=!1!==a.color()&&o),"ngModelChange"===e&&(o=!1!==(a.data.usuario=l)&&o),o},c.G,c.m)),t.ob(8,278528,null,0,b.l,[t.t,t.k,t.D],{ngStyle:[0,"ngStyle"]},null),t.Ab(9,{color:0}),t.ob(10,540672,null,0,h.i,[],{pattern:[0,"pattern"]},null),t.Bb(1024,null,h.d,function(n){return[n]},[h.i]),t.ob(12,16384,null,0,p.Ib,[t.k],null,null),t.Bb(1024,null,h.e,function(n){return[n]},[p.Ib]),t.ob(14,671744,null,0,h.h,[[8,null],[6,h.d],[8,null],[6,h.e]],{model:[0,"model"]},{update:"ngModelChange"}),t.Bb(2048,null,h.f,null,[h.h]),t.ob(16,16384,null,0,h.g,[[4,h.f]],null,null),t.ob(17,49152,null,0,p.F,[t.h,t.k],{pattern:[0,"pattern"],placeholder:[1,"placeholder"],type:[2,"type"]},null),(n()(),t.pb(18,0,null,0,13,"ion-item",[],null,null,null,c.H,c.n)),t.ob(19,49152,null,0,p.G,[t.h,t.k],null,null),(n()(),t.pb(20,0,null,0,2,"ion-label",[],null,null,null,c.I,c.o)),t.ob(21,49152,null,0,p.M,[t.h,t.k],null,null),(n()(),t.Eb(-1,0,["Numero de serie: "])),(n()(),t.pb(23,0,null,0,8,"ion-input",[["placeholder","Ingrese..."]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"keyup"],[null,"keydown.enter"],[null,"ngModelChange"],[null,"ionBlur"],[null,"ionChange"]],function(n,e,l){var o=!0,a=n.component;return"ionBlur"===e&&(o=!1!==t.zb(n,26)._handleBlurEvent()&&o),"ionChange"===e&&(o=!1!==t.zb(n,26)._handleInputEvent(l.target.value)&&o),"keyup"===e&&(o=!1!==a.colorMaterial()&&o),"keydown.enter"===e&&(o=!1!==a.pushMaterial()&&o),"ngModelChange"===e&&(o=!1!==(a.data.numSerie=l)&&o),o},c.G,c.m)),t.ob(24,278528,null,0,b.l,[t.t,t.k,t.D],{ngStyle:[0,"ngStyle"]},null),t.Ab(25,{color:0}),t.ob(26,16384,null,0,p.Mb,[t.k],null,null),t.Bb(1024,null,h.e,function(n){return[n]},[p.Mb]),t.ob(28,671744,null,0,h.h,[[8,null],[8,null],[8,null],[6,h.e]],{model:[0,"model"]},{update:"ngModelChange"}),t.Bb(2048,null,h.f,null,[h.h]),t.ob(30,16384,null,0,h.g,[[4,h.f]],null,null),t.ob(31,49152,null,0,p.F,[t.h,t.k],{placeholder:[0,"placeholder"]},null),(n()(),t.pb(32,0,null,0,2,"ion-button",[["expand","full"]],null,[[null,"click"]],function(n,e,l){var t=!0;return"click"===e&&(t=!1!==n.component.confirmar()&&t),t},c.v,c.b)),t.ob(33,49152,null,0,p.j,[t.h,t.k],{expand:[0,"expand"]},null),(n()(),t.Eb(-1,0,["Generar tickect"])),(n()(),t.pb(35,0,null,0,1,"app-datagrid",[["class","datagrid"]],null,null,null,d.b,d.a)),t.ob(36,638976,null,0,g.a,[i.a,a.c],{info:[0,"info"],mostrar:[1,"mostrar"],libro:[2,"libro"]},null)],function(n,e){var l=e.component,t=n(e,9,0,l.userColor?"green":"red");n(e,8,0,t),n(e,10,0,"\\d[0-9]+"),n(e,14,0,l.data.usuario),n(e,17,0,"\\d[0-9]+","Ingrese...","number");var o=n(e,25,0,l.materialColor?"green":"red");n(e,24,0,o),n(e,28,0,l.data.numSerie),n(e,31,0,"Ingrese..."),n(e,33,0,"full"),n(e,36,0,l.materiales,!0,!1)},function(n,e){n(e,7,0,t.zb(e,10).pattern?t.zb(e,10).pattern:null,t.zb(e,16).ngClassUntouched,t.zb(e,16).ngClassTouched,t.zb(e,16).ngClassPristine,t.zb(e,16).ngClassDirty,t.zb(e,16).ngClassValid,t.zb(e,16).ngClassInvalid,t.zb(e,16).ngClassPending),n(e,23,0,t.zb(e,30).ngClassUntouched,t.zb(e,30).ngClassTouched,t.zb(e,30).ngClassPristine,t.zb(e,30).ngClassDirty,t.zb(e,30).ngClassValid,t.zb(e,30).ngClassInvalid,t.zb(e,30).ngClassPending)})}function C(n){return t.Fb(0,[(n()(),t.pb(0,0,null,null,1,"app-prestamo-material",[],null,null,null,f,m)),t.ob(1,114688,null,0,r,[a.c,i.a],null,null)],function(n,e){n(e,1,0)},null)}var k=t.lb("app-prestamo-material",r,C,{},{},[]),y=l("ZYCi"),v=l("j1ZV");l.d(e,"PrestamoMaterialPageModuleNgFactory",function(){return x});var x=t.mb(s,[],function(n){return t.wb([t.xb(512,t.j,t.bb,[[8,[u.a,k]],[3,t.j],t.x]),t.xb(4608,b.k,b.j,[t.u,[2,b.r]]),t.xb(4608,h.k,h.k,[]),t.xb(4608,p.b,p.b,[t.z,t.g]),t.xb(4608,p.Gb,p.Gb,[p.b,t.j,t.q]),t.xb(4608,p.Kb,p.Kb,[p.b,t.j,t.q]),t.xb(1073742336,b.b,b.b,[]),t.xb(1073742336,h.j,h.j,[]),t.xb(1073742336,h.a,h.a,[]),t.xb(1073742336,p.Cb,p.Cb,[]),t.xb(1073742336,y.n,y.n,[[2,y.t],[2,y.m]]),t.xb(1073742336,v.a,v.a,[]),t.xb(1073742336,s,s,[]),t.xb(1024,y.k,function(){return[[{path:"",component:r}]]},[])])})}}]);